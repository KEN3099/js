const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/@antv-CxpBag_i.js","assets/tslib-Tl-WCo0K.js","assets/detect-browser-ClY_l-h2.js","assets/gl-matrix-DeBWs9CN.js","assets/d3-ease-BopRQYKt.js","assets/d3-interpolate-Dhcid-Zi.js","assets/d3-color-9lF95FHy.js","assets/d3-timer-B6vOUMN9.js","assets/fecha-BnJhuAaO.js","assets/size-sensor-BOeR1b6Q.js","assets/d3-regression-Du5L0964.js","assets/pdfast-eLNHJ9ZQ.js","assets/dayjs-CflfeGVC.js","assets/d3-hierarchy-NYavfCLa.js"])))=>i.map(i=>d[i]);
import{_ as $,a as P}from"./index-CeZUq1ge.js";import{a as B}from"./axios-NIGUFBhG.js";import{u as U}from"./vue-i18n-DLYs8-Ps.js";import{u as j}from"./vue-router-PaDTG1U4.js";import{i as q,j as z,k as G,l as H}from"./ant-design-vue-A2bDz-ar.js";import{r as n,q as J,l as K,m as Q,b as _,e as t,c as p,aa as y,ad as c,u as i,a9 as W,F as X,ag as Y,ax as Z,ay as tt,o as d,a5 as at,ab as et}from"./@vue-C4NowhOt.js";import"./pinia-9OtbBE5K.js";import"./@ant-design-BGOLSkC9.js";import"./@ctrl-DOFZgDuz.js";import"./element-plus-Mh0yyZIL.js";import"./lodash-es-wgX17T5E.js";import"./@vueuse-BBvwCcyR.js";import"./@element-plus-DaL4F972.js";import"./@popperjs-DB1lLFnh.js";import"./dayjs-CflfeGVC.js";import"./async-validator-CRx4dHSJ.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DnZj_KkR.js";import"./@babel-Bq4_u9L9.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-99Xd1yP8.js";import"./dom-align-CRCehRfe.js";import"./throttle-debounce-CUWDS_la.js";import"./@intlify-ZcBRI--x.js";const v=m=>(Z("data-v-7ce9f13f"),m=m(),tt(),m),ot={class:"dashboard"},st={class:"dashboard-content"},ct={class:"main-content"},nt={class:"dashboard-stats"},rt={class:"stat-card"},lt=v(()=>t("div",{class:"stat-icon house-icon"},[t("span",null,"ðŸ ")],-1)),it={class:"stat-info"},dt={class:"stat-title"},ut={class:"stat-value"},_t={class:"stat-card"},pt=v(()=>t("div",{class:"stat-icon sales-icon"},[t("span",null,"ðŸ’°")],-1)),mt={class:"stat-info"},ht={class:"stat-title"},yt={class:"stat-value"},vt={class:"stat-card"},ft=v(()=>t("div",{class:"stat-icon occupancy-icon"},[t("span",null,"ðŸ“ˆ")],-1)),xt={class:"stat-info"},bt={class:"stat-title"},kt={class:"stat-value"},gt={class:"chart-section"},It={class:"orders-section"},Rt=v(()=>t("div",{class:"section-header"},null,-1)),Ft={class:"sidebar-content"},St={class:"card todo-card"},Dt={class:"card-header"},At={class:"card-body"},Lt={key:0,class:"todo-list"},Ct={class:"todo-content"},Nt={class:"todo-header"},Bt={class:"todo-title"},wt={key:0,class:"top-badge"},Ot={class:"todo-detail"},Mt={__name:"Dashboard",setup(m){const{t:a,locale:w}=U();j();let f;const O=async()=>{try{return f||(f=(await P(()=>import("./@antv-CxpBag_i.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))).DualAxes),f}catch(e){console.error("Failed to load chart library:",e)}},M="/api/host/";B.defaults.baseURL=M;const F=n(0),S=n(0),D=n(0),A=n([]),x=n(!1),b=n([]),V=n([]),L=n(null);let u=null;const k=n([]),E=J(()=>[{title:"PID",dataIndex:"pid",key:"pid"},{title:a("order.platform"),dataIndex:"platform",key:"platform"},{title:a("order.reservationCode"),dataIndex:"reservationCode",key:"reservationCode"},{title:a("order.checkIn"),dataIndex:"checkin",key:"checkin"},{title:a("order.checkOut"),dataIndex:"checkout",key:"checkout"},{title:a("order.lengthOfStay"),dataIndex:"lengthOfStay",key:"lengthOfStay"},{title:a("order.guestName"),dataIndex:"guestName",key:"guestName"},{title:a("order.netIncome"),dataIndex:"netIncome",key:"netIncome"},{title:a("order.cleanFee"),dataIndex:"cleanFee",key:"cleanFee"},{title:a("order.currency"),dataIndex:"currency",key:"currency"}]),T=async()=>{try{x.value=!0;const e=await B.get("/host/dashboard");F.value=e.data.data.houseCount,S.value=e.data.data.monthlySales,D.value=e.data.data.occupancyRate+"%",A.value=e.data.data.orderList,b.value=e.data.data.todo||[],V.value=e.data.data.promotion||[];const r=[];e.data.data.months?.forEach(s=>{r.push({month:s.month,sales:s.sales,occupancyRate:s.occupancyRate})}),k.value=r,C(k.value)}catch(e){console.error("èŽ·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:",e)}finally{x.value=!1}},C=async e=>{u&&u.destroy();try{const r=await O();if(!r){console.error("Failed to load DualAxes chart library");return}const s=e.map(o=>o.sales),h=e.map(o=>o.occupancyRate),g=Math.max(...s),I=Math.min(...s),l=Math.max(...h),R=Math.min(...h);u=new r(L.value,{data:[e,e],xField:"month",yField:["sales","occupancyRate"],geometryOptions:[{geometry:"line",color:"#5B8FF9"},{geometry:"line",color:"#5AD8A6"}],legend:{itemName:{formatter:o=>a(o==="occupancyRate"?"dashboard.occupancyRate":"dashboard.monthlySales")}},yAxis:{sales:{min:I*.9,max:g*1.1,nice:!0,line:{style:{stroke:"#5B8FF9"}},tickLine:{style:{stroke:"#5B8FF9"}},label:{style:{fill:"#5B8FF9"},formatter:o=>`${(Number(o)/1e3).toFixed(0)}k`},title:{text:a("dashboard.monthlySales"),style:{fill:"#5B8FF9"}}},occupancyRate:{min:Math.max(0,R-5),max:Math.min(100,l+5),nice:!0,line:{style:{stroke:"#5AD8A6"}},tickLine:{style:{stroke:"#5AD8A6"}},label:{style:{fill:"#5AD8A6"},formatter:o=>`${Number(o).toFixed(0)}%`},title:{text:a("dashboard.occupancyRate"),style:{fill:"#5AD8A6"}}}},tooltip:{formatter:o=>({name:"occupancyRate"in o?a("dashboard.occupancyRate"):a("dashboard.monthlySales"),value:"occupancyRate"in o?`${o.occupancyRate}%`:`${Number(o.sales).toLocaleString()}`})}}),u.render()}catch(r){console.error("Error creating or rendering chart:",r)}};K(()=>{T()}),Q(w,()=>{u&&C(k.value)});const N=e=>e.isTop===1;return(e,r)=>{const s=H,h=q,g=z,I=G;return d(),_("div",ot,[t("div",st,[t("div",ct,[t("div",nt,[p(h,{gutter:16},{default:y(()=>[p(s,{xs:24,sm:8},{default:y(()=>[t("div",rt,[lt,t("div",it,[t("p",dt,c(i(a)("dashboard.houseCount")),1),t("p",ut,c(F.value),1)])])]),_:1}),p(s,{xs:24,sm:8},{default:y(()=>[t("div",_t,[pt,t("div",mt,[t("p",ht,c(i(a)("dashboard.monthlySales")),1),t("p",yt,c(S.value.toLocaleString()),1)])])]),_:1}),p(s,{xs:24,sm:8},{default:y(()=>[t("div",vt,[ft,t("div",xt,[t("p",bt,c(i(a)("dashboard.occupancyRate")),1),t("p",kt,c(D.value),1)])])]),_:1})]),_:1})]),t("div",gt,[t("div",{ref_key:"chartRef",ref:L,class:"chart-container"},null,512)]),t("div",It,[Rt,p(g,{columns:E.value,"data-source":A.value,loading:x.value,pagination:!1,class:"orders-table",scroll:{x:!0}},null,8,["columns","data-source","loading"])])]),t("div",Ft,[t("div",St,[t("div",Dt,[t("h2",null,c(i(a)("todo.todoList")),1)]),t("div",At,[b.value.length>0?(d(),_("div",Lt,[(d(!0),_(X,null,Y(b.value,(l,R)=>(d(),_("div",{key:R,class:at(["todo-item",{"todo-item-top":N(l)}])},[t("div",Ct,[t("div",Nt,[t("span",Bt,c(l.title),1),N(l)?(d(),_("span",wt,c(i(a)("todo.pinned")),1)):et("",!0)]),t("p",Ot,c(l.detail),1)])],2))),128))])):(d(),W(I,{key:1,description:i(a)("todo.noTodoItems")},null,8,["description"]))])])])])])}}},ua=$(Mt,[["__scopeId","data-v-7ce9f13f"]]);export{ua as default};
