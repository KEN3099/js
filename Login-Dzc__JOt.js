import{u as I}from"./vue-router-PaDTG1U4.js";import{a as v}from"./axios-NIGUFBhG.js";import{u as R}from"./vue-i18n-DLYs8-Ps.js";import{_ as S,L as B}from"./index-CeZUq1ge.js";import{F as N,n as q,I as z,v as U,B as C,h as m}from"./ant-design-vue-A2bDz-ar.js";import{r as g,b as V,e as p,c as a,ad as _,u as n,aa as r,o as A,N as h}from"./@vue-C4NowhOt.js";import"./@intlify-ZcBRI--x.js";import"./pinia-9OtbBE5K.js";import"./@ant-design-BGOLSkC9.js";import"./@ctrl-DOFZgDuz.js";import"./element-plus-Mh0yyZIL.js";import"./lodash-es-wgX17T5E.js";import"./@vueuse-BBvwCcyR.js";import"./@element-plus-DaL4F972.js";import"./@popperjs-DB1lLFnh.js";import"./dayjs-CflfeGVC.js";import"./async-validator-CRx4dHSJ.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DnZj_KkR.js";import"./@babel-Bq4_u9L9.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-99Xd1yP8.js";import"./dom-align-CRCehRfe.js";import"./throttle-debounce-CUWDS_la.js";const D={class:"login-container"},E={class:"login-form"},J={class:"login-header"},M={style:{"text-align":"center"}},O={__name:"Login",setup(P){const{t:o}=R(),d=g(),l=g(!1),w="/api/host/";v.defaults.baseURL=w;const s=g({username:null,password:null,remember:!1}),b={username:[{required:!0,message:o("login.usernameRequired"),trigger:"blur"}],password:[{required:!0,message:o("login.passwordRequired"),trigger:"blur"},{min:6,message:o("login.passwordMinLength"),trigger:"blur"}]},y=I(),k=()=>{d.value.validate().then(async()=>{l.value=!0;try{const e=await v.postForm("/user/login",{userName:s.value.username,password:s.value.password});if(e.data.code===200&&e.data.data.satoken!==null){m.success("登录成功"),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("satoken",e.data.data.satoken),e.data.data.groups&&localStorage.setItem("groups",JSON.stringify(e.data.data.groups));let t="/";const i=e.data.data.groups||[];i.includes(2)?t="/todoList":i.includes(4)&&(t="/"),await y.push(t)}else m.error(o("login.invalidCredentials"))}catch(e){e.response&&e.response.data&&e.response.data.message?m.error(e.response.data.message):m.error(o("login.loginFailed"))}finally{l.value=!1}}).catch(e=>{console.log("表单验证失败:",e),l.value=!1})},L=()=>{d.value.resetFields()};return(e,t)=>{const i=z,u=q,x=U,f=C,F=N;return A(),V("div",D,[p("div",E,[p("div",J,[p("h2",null,_(n(o)("login.title")),1)]),a(F,{ref_key:"formRef",ref:d,model:s.value,rules:b,onFinish:k},{default:r(()=>[a(u,{name:"username"},{default:r(()=>[a(i,{value:s.value.username,"onUpdate:value":t[0]||(t[0]=c=>s.value.username=c),size:"large",placeholder:n(o)("login.username")},null,8,["value","placeholder"])]),_:1}),a(u,{name:"password"},{default:r(()=>[a(x,{value:s.value.password,"onUpdate:value":t[1]||(t[1]=c=>s.value.password=c),size:"large",placeholder:n(o)("login.password")},null,8,["value","placeholder"])]),_:1}),a(u,null,{default:r(()=>[a(f,{type:"primary","html-type":"submit",loading:l.value,block:"",size:"large"},{default:r(()=>[h(_(n(o)("login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),a(u,null,{default:r(()=>[a(f,{onClick:L,block:"",size:"large"},{default:r(()=>[h(_(n(o)("common.reset")),1)]),_:1})]),_:1})]),_:1},8,["model"]),p("div",M,[a(B)])])])}}},he=S(O,[["__scopeId","data-v-ac8e1168"]]);export{he as default};
